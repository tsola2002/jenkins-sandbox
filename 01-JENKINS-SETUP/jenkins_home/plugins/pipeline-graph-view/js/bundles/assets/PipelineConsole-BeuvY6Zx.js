const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./ConsoleLogStream-G6D9AFo_.js","./PipelineGraphModel-CLNzvVBX.js","./PipelineGraph-336iZjPc.js"])))=>i.map(i=>d[i]);
(function(){"use strict";try{if(typeof document<"u"){var e=document.createElement("style");e.appendChild(document.createTextNode('.ansi-fg-0{color:var(--black, #333)}.ansi-fg-1{color:var(--danger, #cc0003)}.ansi-fg-2{color:var(--success, #138347)}.ansi-fg-3{color:var(--warning, #ea6b19)}.ansi-fg-4{color:var(--primary, #0b6aa2)}.ansi-fg-5{color:var(--unknown-color, #bd0fe1)}.ansi-fg-6{color:var(--paused-color, #24b0d5)}.ansi-fg-7{color:var(--white, #fff)}.ansi-bg-0{background:var(--black, #333)}.ansi-bg-1{background:var(--danger, #cc0003)}.ansi-bg-2{background:var(--success, #138347)}.ansi-bg-3{background:var(--warning, #ea6b19)}.ansi-bg-4{background:var(--primary, #0b6aa2)}.ansi-bg-5{background:var(--unknown-color, #bd0fe1)}.ansi-bg-6{background:var(--paused-color, #24b0d5)}.ansi-bg-7{background:var(--white, #fff)}.pgv-sticky-sidebar{position:sticky;top:calc(var(--header-height) + var(--section-padding))}.pgv-skeleton-column{display:flex;flex-direction:column;gap:.75rem}.pgv-skeleton{background:var(--button-background);border:1.5px solid color-mix(in srgb,var(--text-color-secondary) 3%,transparent);border-radius:var(--form-input-border-radius);height:100%;animation:pulse-skeleton 2s both ease-in-out infinite}@keyframes pulse-skeleton{50%{background:var(--button-background--active)}}.pgv-stages-customization{display:grid;grid-template-columns:auto 1fr auto;padding-right:.6rem;min-width:220px}.pgv-stages-customization span{color:var(--text-color-secondary)}.pgv-stages-customization select{position:absolute;top:0;right:0;bottom:0;left:0;opacity:0;cursor:pointer}.pgv-stages-customization:has(select:disabled){opacity:.5;pointer-events:none}.pgw-filter-bar{position:relative;display:grid;grid-template-columns:1fr auto;margin-bottom:.75rem}.pgw-filter-bar:before{content:"";position:absolute;top:0;right:0;bottom:0;left:0;border-radius:var(--form-input-border-radius);border:var(--jenkins-border, 2px solid color-mix(in srgb, var(--text-color-secondary) 10%, transparent));box-shadow:var(--form-input-glow);transition:var(--standard-transition)}.pgw-filter-bar button{border-radius:.4rem;padding-inline:0;width:42px}.pgw-filter-bar button:before,.pgw-filter-bar button:after{top:5px;right:5px;bottom:5px;left:5px}.pgw-filter-bar .jenkins-search{--search-bar-height: 2.625rem}.pgw-filter-bar .jenkins-search input{border:none!important;box-shadow:none!important;background:none!important;padding:0 0 0 var(--search-bar-height)}.pgw-filter-bar:hover:before{border-color:var(--input-border-hover)}.pgw-filter-bar:has(input:focus):before{border-color:var(--focus-input-border);box-shadow:var(--form-input-glow--focus)}.pgv-tree{padding:0;display:flex;flex-direction:column;gap:.125rem}.pgv-tree-stage{position:relative;margin:0;padding:0;display:flex;flex-direction:column;gap:.125rem}.pgv-tree-item-container{position:relative;-webkit-appearance:none;-moz-appearance:none;appearance:none;z-index:0;font-weight:400;border-radius:var(--form-input-border-radius);cursor:pointer;background:transparent;outline:none;border:none}.pgv-tree-item-container:before,.pgv-tree-item-container:after{position:absolute;content:"";top:0;right:0;bottom:0;left:0;z-index:-1;border-radius:inherit;transition:var(--standard-transition);pointer-events:none}.pgv-tree-item-container:before{background-color:var(--item-background);border:var(--jenkins-border--subtle)}.pgv-tree-item-container:after{box-shadow:0 0 0 .5rem transparent}.pgv-tree-item-container:focus-visible{outline:none}.pgv-tree-item-container:not(:disabled):hover:before,.pgv-tree-item-container:not(:disabled):focus-visible:before,.pgv-tree-item-container:not(:disabled)[aria-describedby]:before,.pgv-tree-item-container:not(:disabled)[aria-expanded=true]:before{background-color:var(--item-background--hover)}.pgv-tree-item-container:not(:disabled):active{outline:none!important;z-index:1}.pgv-tree-item-container:not(:disabled):active:before{background-color:var(--item-background--active)}.pgv-tree-item-container:not(:disabled):active:active:after{box-shadow:0 0 0 .25rem var(--item-box-shadow--focus)}.pgv-tree-item-container:not(:disabled):has(.pgv-tree-item--active):before{background-color:var(--item-background--active)}.pgv-tree-item-container:not(:disabled):focus-visible:after{box-shadow:0 0 0 .2rem var(--text-color)!important;opacity:1!important}.pgv-tree-item-container:not(:hover,.pgv-tree-item-container:active,.pgv-tree-item-container:focus,.pgv-tree-item-container:has(.pgv-tree-item--active)):before{border-color:transparent}.pgv-tree-item{display:grid;grid-template-columns:auto 1fr auto;justify-content:start;align-items:center;text-decoration:none;color:var(--text-color);position:relative;padding:.5rem .7rem;-webkit-mask-image:linear-gradient(90deg,white calc(100% - 3rem),transparent calc(100% - 1.5rem));mask-image:linear-gradient(90deg,white calc(100% - 3rem),transparent calc(100% - 1.5rem))}.pgv-tree-item:visited,.pgv-tree-item:link{color:inherit;text-decoration:none}.pgv-tree-item--active{font-weight:450}.pgv-tree-item--active .pgv-status-icon svg>*{stroke-width:35px}.pgv-tree-item__content{display:grid;grid-template-columns:auto 1fr;align-items:start;gap:.65rem;min-width:0}.pgv-tree-item__info{display:flex;flex-direction:row;gap:.65rem}.pgv-tree-item__name,.pgv-tree-item__description{overflow:hidden;white-space:nowrap}.pgv-tree-item__description{color:var(--text-color-secondary)}.pgv-tree-item__toggle{position:absolute;top:0;right:0;bottom:0;aspect-ratio:1;transition:var(--standard-transition);-webkit-appearance:none;-moz-appearance:none;appearance:none;background:none;padding:0;border:none;cursor:pointer;color:var(--text-color-secondary);z-index:1}.pgv-tree-item__toggle--active{rotate:90deg}.pgv-tree-item__toggle svg{width:1rem;height:1rem}.pgv-tree-item__toggle svg *{stroke-width:42px}.pgv-tree-item__toggle:hover{color:var(--text-color)}.pgv-tree-item--skeleton{pointer-events:none;color:var(--text-color-secondary)!important}.pgv-status-icon{display:flex;align-items:center}.pgv-status-icon svg{width:1.375rem;height:1.375rem}.pgv-tree-children{position:relative;display:flex;flex-direction:column;padding-left:2.075rem}.pgv-tree-children:before{content:"";position:absolute;top:.375rem;left:calc(1.3875rem - var(--jenkins-border-width, 2px) / 2);bottom:.375rem;background-color:var(--jenkins-border-color, color-mix(in srgb, var(--text-color-secondary) 25%, transparent));width:var(--jenkins-border-width, 2px);border-radius:var(--form-input-border-radius)}.pgv-filter-button{transition:var(--standard-transition)}.pgv-filter-button svg{width:1.375rem;height:1.375rem}.pgv-filter-button--unchecked{opacity:.75;color:var(--text-color-secondary)!important}.jenkins-dropdown__heading{display:grid;grid-template-columns:1fr auto}.pgv-reset-button{padding:0;min-height:0}.pgv-reset-button:before,.pgv-reset-button:after{display:none}.pgv-scroll-to-top-bottom{position:fixed;bottom:calc(var(--section-padding) * 1 + (var(--pgv-offset-bottom, 0px)));right:calc(var(--section-padding) * 2);display:flex;gap:.375rem;padding:.375rem;border-radius:100px;box-shadow:var(--dropdown-box-shadow);background:color-mix(in sRGB,var(--card-background) 85%,transparent);-webkit-backdrop-filter:var(--dropdown-backdrop-filter);backdrop-filter:var(--dropdown-backdrop-filter);opacity:0;scale:.25;transition:opacity var(--elastic-transition),scale var(--elastic-transition);pointer-events:none;z-index:1}.pgv-scroll-to-top-bottom--visible{opacity:1;scale:1;pointer-events:auto}@media (prefers-reduced-motion: reduce){.pgv-scroll-to-top-bottom{transition:none}}.pgv-scroll-to-top-bottom .jenkins-button{padding:0;width:2.375rem;border-radius:100px}.pgv-scroll-to-top-bottom .jenkins-button svg{transition:translate .1s ease-in-out}.pgv-scroll-to-top-bottom .jenkins-button:not(:disabled):first-of-type:hover svg{translate:0 -1px}.pgv-scroll-to-top-bottom .jenkins-button:not(:disabled):last-of-type:hover svg{translate:0 1px}.pgv-split-view__container{position:relative;display:grid;gap:var(--section-padding);animation:fade-in .1s ease-in-out both}@keyframes fade-in{0%{opacity:0}}.pgv-split-view__side-panel{position:relative;display:flex;flex-direction:column}.pgv-split-view__side-panel--vertical{display:grid}.pgv-split-view__divider{position:absolute;right:calc(var(--section-padding) * -1);top:0;bottom:0;width:var(--section-padding);cursor:col-resize;z-index:1}.pgv-split-view__divider:after{content:"";position:absolute;right:calc(50% - var(--jenkins-border-width, 2px) / 2);top:0;bottom:0;width:var(--jenkins-border-width, 2px);border-radius:5px;transition:var(--standard-transition);background-color:var(--text-color-secondary);opacity:0}.pgv-split-view__divider:hover:after{opacity:.4;scale:150% 100%}.pgv-split-view__divider:active:after{opacity:.8;scale:200% 100%}.pgv-split-view__divider--vertical{top:unset;left:0;right:0;bottom:calc(var(--section-padding) * -1);width:unset;height:var(--section-padding);cursor:row-resize}.pgv-split-view__divider--vertical:after{left:0;right:0;top:unset;width:unset;bottom:calc(50% - var(--jenkins-border-width, 2px) / 2);height:var(--jenkins-border-width, 2px)}.pgv-split-view__divider--vertical:hover:after{opacity:.4;scale:100% 150%}.pgv-split-view__divider--vertical:active:after{opacity:.8;scale:100% 200%}.pgv-stage-details{--bg-color: var(--color, var(--text-color-secondary));position:relative;display:grid;grid-template-columns:1fr auto;gap:.5rem;padding:.125rem calc(1rem + var(--jenkins-border-width, 2px));padding-right:.7rem;border-radius:var(--form-input-border-radius);margin-bottom:.75rem;z-index:101}.pgv-stage-details:before{content:"";position:absolute;top:0;right:0;bottom:0;left:0;background:oklch(from var(--bg-color) l c h/.075);border:var(--jenkins-border-width, 2px) solid oklch(from var(--bg-color) l c h/.1);border-radius:inherit;transition:var(--standard-transition);pointer-events:none}@media (prefers-contrast: more){.pgv-stage-details:before{border-color:var(--text-color)}}.pgv-stage-details>div{display:flex;align-items:center;gap:.75rem}.pgv-stage-details>div>div{display:contents}.pgv-stage-details>div svg{width:1.375rem;height:1.375rem}.pgv-stage-details h2{font-size:var(--font-size-sm);font-weight:var(--font-bold-weight);margin:0;text-box:trim-both}.pgv-stage-details .jenkins-button{--button-background--hover: oklch(from currentColor l c h / .1);--button-background--active: oklch(from currentColor l c h / .2);--button-box-shadow--focus: oklch(from currentColor l c h / .1);color:var(--color)!important;border-radius:.4rem;margin-inline:-.85rem;padding-inline:1.125rem}.pgv-stage-details .jenkins-button:before,.pgv-stage-details .jenkins-button:after{top:3px;right:7px;bottom:3px;left:7px}.pgv-stage-details ul{display:flex;gap:1.25rem;padding:0;margin:0}.pgv-stage-details ul li,.pgv-stage-details ul li span{display:flex;align-items:center;gap:1ch;text-box:trim-both}.pgv-stage-details ul li svg{width:1.125rem;height:1.125rem;flex-shrink:0}.pgv-stage-details ul li svg *{stroke-width:36px}.pgv-stage-details__running{position:absolute;top:0;right:0;bottom:0;left:0;border-radius:inherit;background:var(--bg-color);pointer-events:none;animation:pulse 2s ease-in-out infinite;opacity:0}@keyframes pulse{50%{opacity:.1}}.pgv-stage-steps{display:flex;flex-direction:column;gap:.375rem;border:var(--jenkins-border, 2px solid color-mix(in srgb, var(--text-color-secondary) 10%, transparent));background:var(--card-background);border-radius:var(--form-input-border-radius);padding:.375rem}.pgv-step-detail-group{position:relative}.pgv-step-detail-group:hover{z-index:100}.pgv-step-detail-header{position:sticky;top:calc(var(--header-height) + .375rem);z-index:1;display:grid;grid-template-columns:1fr auto;border-radius:.375rem;cursor:pointer;width:100%;box-shadow:0 0 0 .375rem var(--card-background);background-color:var(--card-background);padding:0 0 0 .5rem!important}.pgv-step-detail-header>a:first-of-type{display:grid;grid-template-columns:1fr auto;align-items:center;justify-content:stretch;gap:1rem;text-decoration:none;color:var(--text-color);min-height:2.5rem}.pgv-step-detail-header .jenkins-button{padding:0 .6rem;color:var(--text-color-secondary)!important;margin-left:.45rem}.pgv-step-detail-header .jenkins-button:before,.pgv-step-detail-header .jenkins-button:after{display:none}.pgv-step-detail-header .jenkins-button svg{width:1rem;height:1rem}.pgv-step-detail-header .jenkins-button:hover{color:var(--text-color)!important}.pgv-step-detail-header__content{display:flex;align-items:center;font-size:var(--font-size-sm);gap:.75rem;padding-left:.15rem;overflow:hidden}.pgv-step-detail-header__content span{max-width:80%;overflow:hidden;text-overflow:ellipsis;color:var(--text-color-secondary);font-family:var(--font-family-mono)}.pgv-step-detail-header__content span:first-of-type{color:var(--text-color);font-weight:var(--font-bold-weight);font-family:var(--font-family-sans)}.pgv-step-detail-header__content .pgv-step-detail-header__chevron{transition:var(--standard-transition);width:1rem;height:1rem;margin-inline:-.25rem;flex-shrink:0}.pgv-step-detail-header__content>svg:first-of-type{width:1.375rem;height:1.375rem}.pgv-step-detail-header__actions{display:flex;align-items:center;gap:.65rem}.pgv-step-detail-header__actions>button{min-width:38px;padding-inline:0!important}.pgv-show-more-logs{position:sticky;top:calc(var(--header-height) + .375rem + .375rem + 2.375rem);background:var(--card-background);box-shadow:0 0 .375rem var(--card-background);z-index:10;border-radius:.375rem;width:100%}.console-text div{text-indent:0;display:inline-block;overflow-wrap:anywhere}pre.console-output-line{text-align:left;padding:0;margin:0;border-radius:0}a.console-line-number{text-align:right;margin-right:14px;color:var(--text-color-secondary);white-space:nowrap;display:inline-block;flex-shrink:0;-webkit-user-select:none;user-select:none}div.console-output-line-anchor{position:relative;top:-50px;visibility:hidden}div.console-output-line{position:relative;display:flex;padding-block:2px}div.console-output-line:before{content:"";position:absolute;top:0;right:0;bottom:0;left:0;background-color:color-mix(in srgb,var(--text-color-secondary) 5%,transparent);border:var(--jenkins-border-width, 2px) solid color-mix(in srgb,var(--text-color-secondary) 2.5%,transparent);border-radius:.375rem;opacity:0;transition:opacity var(--standard-transition);pointer-events:none}div.console-output-line:hover:before{opacity:1}')),document.head.appendChild(e)}}catch(t){console.error("vite-plugin-css-injected-by-js",t)}})();
import{r as p,j as e,R as y,g as X,h as H,i as Z}from"./PipelineGraphModel-CLNzvVBX.js";import{S as Q}from"./stages-CpbOY1zP.js";import{a as O,i as G,r as ee,c as E,S as V,T as $,u as te,e as se,b as ne,d as ie,f as oe}from"./PipelineGraph-336iZjPc.js";import{u as F,M as T,S as D}from"./user-preference-provider-BvdO0vbY.js";import{u as z,_ as U}from"../pipeline-console-view-bundle.js";function K({items:t,disabled:s,className:h}){const[n,u]=p.useState(!1),o=()=>u(!0),r=()=>u(!1);return e.jsx(O,{content:"More actions",children:e.jsx(G,{visible:n,onClickOutside:r,...Y,content:e.jsx("div",{className:"jenkins-dropdown",children:t.map((i,d)=>{if(i==="separator")return e.jsx("div",{className:"jenkins-dropdown__separator"},`separator-${d}`);if(p.isValidElement(i))return e.jsx("div",{className:"jenkins-dropdown__custom-item",children:i},d);const x=i;return e.jsxs("a",{className:"jenkins-dropdown__item",href:x.href,target:x.target,download:x.download,children:[e.jsx("div",{className:"jenkins-dropdown__item__icon",children:x.icon}),x.text]},d)})}),children:e.jsx("button",{className:"jenkins-button "+h,type:"button",disabled:s,onClick:n?r:o,children:e.jsxs("div",{className:"jenkins-overflow-button__ellipsis",children:[e.jsx("span",{}),e.jsx("span",{}),e.jsx("span",{})]})})})})}const Y={theme:"dropdown",duration:250,touch:!0,animation:"dropdown",interactive:!0,offset:[0,0],placement:"bottom-start",arrow:!1};function re({children:t}){const s=document.getElementById("console-pipeline-overflow-root");return s?ee.createPortal(t,s):(console.error("DropdownPortal: Target container not found!"),null)}function W({height:t}){return e.jsx("div",{className:"pgv-skeleton",style:t?{height:`${t}rem`}:{}})}function le(){const{mainViewVisibility:t,setMainViewVisibility:s,stageViewPosition:h,setStageViewPosition:n,isMobile:u}=F();if(u)return null;const o=i=>{s(i.target.value)},r=i=>{n(i.target.value)};return e.jsxs(e.Fragment,{children:[e.jsxs("label",{className:"jenkins-dropdown__item pgv-stages-customization",htmlFor:"main-view-visibility",children:[e.jsx("div",{className:"jenkins-dropdown__item__icon",children:e.jsx(ae,{mainViewVisibility:t,stageViewPosition:h})}),"Views",e.jsxs("span",{children:[t===T.BOTH&&"Graph and stages",t===T.GRAPH_ONLY&&"Graph",t===T.STAGES_ONLY&&"Stages"]}),e.jsxs("select",{id:"main-view-visibility",value:t,onChange:o,children:[e.jsx("option",{value:T.BOTH,children:"Graph and stages"}),e.jsx("option",{value:T.GRAPH_ONLY,children:"Graph"}),e.jsx("option",{value:T.STAGES_ONLY,children:"Stages"})]})]}),e.jsxs("label",{className:"jenkins-dropdown__item pgv-stages-customization",htmlFor:"stage-view-position",children:[e.jsx("div",{className:"jenkins-dropdown__item__icon",children:e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 512 512",children:[e.jsx("circle",{cx:"128",cy:"96",r:"48",fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"32"}),e.jsx("circle",{cx:"256",cy:"416",r:"48",fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"32"}),e.jsx("path",{fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"32",d:"M256 256v112"}),e.jsx("circle",{cx:"384",cy:"96",r:"48",fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"32"}),e.jsx("path",{d:"M128 144c0 74.67 68.92 112 128 112M384 144c0 74.67-68.92 112-128 112",fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"32"})]})}),"Graph position",e.jsx("span",{children:h===D.TOP?"Top":"Left"}),e.jsxs("select",{id:"stage-view-position",value:h,onChange:r,disabled:t===T.STAGES_ONLY,children:[e.jsx("option",{value:D.TOP,children:"Top"}),e.jsx("option",{value:D.LEFT,children:"Left"})]})]}),e.jsx("div",{className:"jenkins-dropdown__separator"})]})}function ae({mainViewVisibility:t,stageViewPosition:s}){if(t==="both"&&s==="top")return e.jsx("svg",{width:"512px",height:"512px",viewBox:"0 0 512 512",version:"1.1",xmlns:"http://www.w3.org/2000/svg",children:e.jsxs("g",{fill:"none",fillRule:"evenodd",stroke:"currentColor",strokeWidth:"32",children:[e.jsx("rect",{x:"31",y:"86",width:"450",height:"340",rx:"70"}),e.jsx("line",{x1:"31",y1:"180",x2:"470",y2:"180"}),e.jsx("line",{x1:"184",y1:"180",x2:"184",y2:"420"})]})});if(t==="both"&&s==="left")return e.jsx("svg",{width:"512px",height:"512px",viewBox:"0 0 512 512",version:"1.1",xmlns:"http://www.w3.org/2000/svg",children:e.jsxs("g",{fill:"none",fillRule:"evenodd",stroke:"currentColor",strokeWidth:"32",children:[e.jsx("rect",{x:"31",y:"86",width:"450",height:"340",rx:"70"}),e.jsx("line",{x1:"150",y1:"100",x2:"150",y2:"420"}),e.jsx("line",{x1:"280",y1:"100",x2:"280",y2:"420"})]})});if(t==="graphOnly"&&s==="top")return e.jsx("svg",{width:"512px",height:"512px",viewBox:"0 0 512 512",version:"1.1",xmlns:"http://www.w3.org/2000/svg",children:e.jsxs("g",{fill:"none",fillRule:"evenodd",stroke:"currentColor",strokeWidth:"32",children:[e.jsx("rect",{x:"31",y:"86",width:"450",height:"340",rx:"70"}),e.jsx("line",{x1:"31",y1:"180",x2:"470",y2:"180"})]})});if(t==="stagesOnly"||t==="graphOnly"&&s==="left")return e.jsx("svg",{width:"512px",height:"512px",viewBox:"0 0 512 512",version:"1.1",xmlns:"http://www.w3.org/2000/svg",children:e.jsxs("g",{fill:"none",fillRule:"evenodd",stroke:"currentColor",strokeWidth:"32",children:[e.jsx("rect",{x:"31",y:"86",width:"450",height:"340",rx:"70"}),e.jsx("line",{x1:"184",y1:"100",x2:"184",y2:"420"})]})})}function ce({disabled:t}){const[s,h]=p.useState(!1),{visibleStatuses:n,toggleStatus:u,resetStatuses:o,allVisible:r}=z(),i=[{key:"running",text:"Running",status:y.running},{key:"success",text:"Successful",status:y.success},{key:"failure",text:"Failed",status:y.failure},{key:"unstable",text:"Unstable",status:y.unstable},{key:"aborted",text:"Aborted",status:y.aborted},{key:"skipped",text:"Skipped",status:y.skipped},{key:"not_built",text:"Not built",status:y.not_built}],d=()=>h(!0),x=()=>h(!1);return e.jsx(O,{content:"Filter",children:e.jsx(G,{...Y,visible:s,onClickOutside:x,placement:"bottom",appendTo:document.body,offset:[0,-1],content:e.jsxs("div",{className:"jenkins-dropdown","data-testid":"filter-dropdown",children:[e.jsxs("div",{className:"jenkins-dropdown__heading",children:["Filter",!r&&e.jsx("button",{className:"jenkins-button jenkins-button--tertiary jenkins-!-accent-color pgv-reset-button",onClick:o,children:"Reset"})]}),i.map((m,f)=>e.jsxs("button",{className:E("jenkins-dropdown__item","pgv-filter-button",{"pgv-filter-button--unchecked":!n.includes(m.status)}),onClick:()=>u(m.status),children:[e.jsx("div",{className:"jenkins-dropdown__item__icon",children:e.jsx(V,{status:m.status,skeleton:!n.includes(m.status),percentage:0})}),m.text]},f))]}),children:e.jsx("button",{className:E("jenkins-button",{"jenkins-button--tertiary":r},{"jenkins-!-accent-color":!r}),type:"button",disabled:t,onClick:s?x:d,"aria-label":"Filter",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 512 512",children:e.jsx("path",{fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:r?36:42,d:"M32 144h448M112 256h288M208 368h96"})})})})})}function de({stages:t,selected:s,onNodeSelect:h}){const{search:n,setSearch:u,visibleStatuses:o}=z(),r=A(n,o,t),i=p.useCallback((d,x)=>{h(d,x)},[h]);return t.length===1&&t[0].placeholder?null:e.jsxs("div",{children:[e.jsxs("div",{className:"pgw-filter-bar",children:[e.jsxs("div",{className:"jenkins-search",children:[e.jsx("div",{className:"jenkins-search__icon",children:e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 512 512",children:[e.jsx("path",{d:"M221.09 64a157.09 157.09 0 10157.09 157.09A157.1 157.1 0 00221.09 64z",fill:"none",stroke:"currentColor",strokeMiterlimit:"10",strokeWidth:"32"}),e.jsx("path",{fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeMiterlimit:"10",strokeWidth:"32",d:"M338.29 338.29L448 448"})]})}),e.jsx("input",{className:"jenkins-input jenkins-search__input",placeholder:"Search",type:"search",autoComplete:"off",autoCorrect:"off",autoCapitalize:"off",spellCheck:"false",value:n,onChange:d=>u(d.target.value)})]}),e.jsx(ce,{})]}),r.length===0&&e.jsxs("div",{className:"jenkins-notice",children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 512 512",children:e.jsx("path",{fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:36,d:"M32 144h448M112 256h288M208 368h96"})}),e.jsx("div",{children:"No stages"})]}),e.jsx("ol",{className:"pgv-tree",role:"tree","aria-label":"Pipeline Stages",children:r.map(d=>e.jsx(ue,{stage:d,selected:String(s),onSelect:i},d.id))})]})}const ue=p.memo(function t({stage:s,selected:h,onSelect:n}){const{search:u,visibleStatuses:o,allVisible:r}=z(),i=s.children&&s.children.length>0,d=String(s.id)===h,[x,m]=p.useState(f(s));function f(j){var w;return(w=j.children)==null?void 0:w.some(k=>String(k.id)===h||f(k))}const S=j=>{j.stopPropagation(),m(!x)};return p.useEffect(()=>{f(s)&&m(!0)},[h]),p.useEffect(()=>{(u.length||!r)&&A(u,o,[s]).length!==0&&m(!0)},[u,o,r]),e.jsxs("li",{className:"pgv-tree-stage",role:"treeitem",...i?{"aria-expanded":x}:{},"aria-selected":d,"aria-labelledby":`stage-${s.id}-name`,children:[e.jsxs("div",{className:"pgv-tree-item-container",children:[e.jsx("a",{href:"?selected-node="+s.id,onClick:j=>{j.button!==0||j.metaKey||j.ctrlKey||(j.preventDefault(),history.replaceState({},"","?selected-node="+s.id),d||n(j,String(s.id)),m(!x))},className:E("pgv-tree-item",{"pgv-tree-item--active":d,"pgv-tree-item--skeleton":s.skeleton}),"aria-labelledby":`stage-${s.id}-name`,children:e.jsxs("div",{className:"pgv-tree-item__content",children:[e.jsx("div",{className:"pgv-status-icon",children:e.jsx(V,{status:s.state,percentage:s.completePercent,skeleton:s.skeleton})}),e.jsxs("div",{className:"pgv-tree-item__info",children:[e.jsxs("div",{className:"pgv-tree-item__name",id:`stage-${s.id}-name`,children:[e.jsx("span",{className:"jenkins-visually-hidden",children:"Stage "}),s.name]}),e.jsx("div",{className:"pgv-tree-item__description",children:e.jsx($,{ms:s.totalDurationMillis})})]})]})}),i&&e.jsx("button",{className:E("pgv-tree-item__toggle",{"pgv-tree-item__toggle--active":x}),onClick:S,"aria-label":`${x?"Collapse":"Expand"} ${s.name}`,children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 512 512",children:e.jsx("path",{fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"48",d:"M184 112l144 144-144 144"})})})]}),i&&x&&e.jsx("div",{className:"pgv-tree-children",children:e.jsx("ol",{role:"group","aria-label":`Stages in ${s.name}`,className:"pgv-tree",children:s.children.map(j=>e.jsx(t,{stage:j,selected:h,onSelect:n},j.id))})})]})}),A=(t,s,h)=>h.map(n=>{const u=n.children?A(t,s,n.children):[];return n.name.toLowerCase().includes(t.toLowerCase())&&s.includes(n.state)||u.length>0?{...n,children:u}:null}).filter(n=>n!==null),B=150*1024,he=1e3;function pe(t){const{run:s,loading:h}=te({currentRunPath:t.currentRunPath,previousRunPath:t.previousRunPath}),[n,u]=p.useState(""),[o,r]=p.useState([]),[i,d]=p.useState([]),[x,m]=p.useState(new Map),[f,S]=p.useState(!1),j=p.useRef([]),w=p.useCallback(async(l,c,a)=>{const g=x.get(l)??{lines:[],startByte:0-B,endByte:-1,stepId:l};if(g.startByte>0&&!c)return;const v=await X(l,a);if(!v)return;const P=v.text.trim().split(`
`)||[];g.endByte>0&&g.endByte<=a?g.lines=[...g.lines,...P]:(g.lines=P,g.startByte=v.startByte),g.endByte=v.endByte,m(q=>new Map(q).set(l,g))},[]),k=p.useCallback(l=>{const c=new URLSearchParams(document.location.search.substring(1));let a=c.get("selected-node");if(!a)return!1;S(!0);const g=l.find(P=>P.id===a),v=[];return g&&(a=g.stageId,v.push(g.id),w(g.id,!1,parseInt(c.get("start-byte")||`${0-B}`))),u(a),r(v),!0},[w]),b=l=>{if(f)return;let c=l.find(a=>a!==void 0);if(!l||l.length===0||!c)return null;for(const a of l){const g=a.state.toLowerCase(),v=c==null?void 0:c.state.toLowerCase();switch(g){case y.running:case y.queued:case y.paused:return a;case y.unstable:case y.failure:case y.aborted:if(v&&g<v)return a;continue;default:v&&g<=v&&(c=a)}}return c};p.useEffect(()=>{H().then(l=>{if(l=l||[],d(l),!k(l)){const a=b(l);a&&(u(a.stageId),a.stageId&&(r(g=>[...g,a.id]),w(a.id,!1,0-B)))}return s!=null&&s.complete||ge({getStateUpdateFn:H,onData:a=>{const g=JSON.stringify(j.current)!==JSON.stringify(a);if(f){const v=b(l);v&&(u(v.stageId),v.stageId&&(r(P=>[...P,v.id]),w(v.id,!1,0-B)))}g&&(d(a),j.current=a)},checkComplete:()=>!(s!=null&&s.complete),interval:he}),null}).catch(l=>{console.error("Error in getRunSteps:",l)})},[s==null?void 0:s.stages]);const C=p.useCallback(l=>{if(S(!0),!l||l===n)return;const c=i.filter(v=>v.stageId===l),a=c[c.length-1],g=a?[a.id]:[];history.replaceState({},"","?selected-node="+l),u(l),r(v=>[...v,...g]),a&&w(a.id,!1,0-B)},[n,i,w]),_=l=>{S(!0),o.includes(l)?r(c=>c.filter(a=>a!==l)):(r(c=>[...c,l]),w(l,!1,0-B))},N=(l,c)=>{w(l,!0,c)},L=l=>i.filter(c=>c.stageId===l),M=l=>{const c=new Map;return i.forEach(a=>{a.stageId===l&&x.has(a.id)&&c.set(a.id,x.get(a.id))}),c};return{openStage:(()=>{const l=c=>{for(const a of c){if(String(a.id)===n)return a;if(a.children.length>0){const g=l(a.children);if(g)return g}}return null};return n?l((s==null?void 0:s.stages)||[]):null})(),openStageSteps:L(n),openStageStepBuffers:M(n),expandedSteps:o,stages:(s==null?void 0:s.stages)||[],handleStageSelect:C,onStepToggle:_,onMoreConsoleClick:N,loading:h}}const ge=({getStateUpdateFn:t,onData:s,checkComplete:h,interval:n=1e3})=>{let u=!0;return setTimeout(async()=>{for(;u;){const r=await t()||[];if(s(r),h(r)){u=!1;break}await new Promise(i=>setTimeout(i,n))}},n),()=>{u=!1}},xe=p.lazy(()=>U(()=>import("./ConsoleLogStream-G6D9AFo_.js"),__vite__mapDeps([0,1,2]),import.meta.url));async function fe(){const t=await Z();return{lines:(t==null?void 0:t.split(`
`))??[],startByte:0,endByte:0}}function je(){const t={id:"step-1",name:"Step 1",title:"Step 1 Title",state:y.success,completePercent:100,type:"STEP",startTimeMillis:0,totalDurationMillis:0,stageId:"",pauseDurationMillis:0},[s,h]=p.useState();return p.useEffect(()=>{fe().then(n=>(h(n),n)).catch(n=>console.log(n))},[]),e.jsx("div",{className:"pgv-stage-steps",children:e.jsx("div",{className:"pgv-step-detail-group",children:e.jsx(xe,{logBuffer:s??{lines:[],startByte:0,endByte:0},onMoreConsoleClick:()=>{},step:t,maxHeightScale:.65})})})}function ve(){const[t,s]=p.useState(!0),[h,n]=p.useState(!1),[u,o]=p.useState(!1);p.useEffect(()=>{const d=()=>{const m=window.pageYOffset||document.documentElement.scrollTop,f=window.innerHeight,S=document.documentElement.scrollHeight,j=m<=10,w=m+f>=S-10,k=S>f+10;s(j),n(w),o(k);const b=S-(m+f),C=Math.max(0,Math.min(100,100-b));document.documentElement.style.setProperty("--pgv-offset-bottom",`${C}px`)};d(),window.addEventListener("scroll",d),window.addEventListener("resize",d);const x=new MutationObserver(d);return x.observe(document.body,{childList:!0,subtree:!0,attributes:!0,characterData:!0}),()=>{window.removeEventListener("scroll",d),window.removeEventListener("resize",d),x.disconnect()}},[]);const r=()=>{window.scrollTo({top:0})},i=()=>{window.scrollTo({top:document.documentElement.scrollHeight})};return e.jsxs("div",{className:E("pgv-scroll-to-top-bottom",{"pgv-scroll-to-top-bottom--visible":u}),"aria-hidden":!u,children:[e.jsx("button",{onClick:r,className:"jenkins-button",disabled:t,children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 512 512",children:e.jsx("path",{fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"48",d:"M112 244l144-144 144 144M256 120v292"})})}),e.jsx("button",{onClick:i,className:"jenkins-button",disabled:h,children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 512 512",children:e.jsx("path",{fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"48",d:"M112 268l144 144 144-144M256 392V100"})})})]})}function I(t){const{setTreeViewWidth:s,setStageViewWidth:h,setStageViewHeight:n,treeViewWidth:u,stageViewWidth:o,stageViewHeight:r}=F(),{direction:i="horizontal",storageKey:d}=t,[x,m]=p.useState(!1),f=i==="vertical",S=d==="stages"?u:d==="graph"?f?r:o:300;p.useEffect(()=>{w(d==="stages"?u:d==="graph"?i==="vertical"?r:o:300)},[i,u,o,r,d]);const[j,w]=p.useState(S),k=p.useRef(null),b=c=>{m(!0),c.preventDefault()},C=()=>m(!1),_=c=>{if(!x)return;const a=i==="vertical"?c.clientY-M():c.clientX-M(),g=Math.max(i==="vertical"?100:200,Math.min(a,1500));w(g),d==="stages"?s(g):d==="graph"&&(i==="vertical"?n(g):h(g))},N=()=>{const c=d==="stages"?300:d==="graph"?f?250:600:300;w(c),d==="stages"?s(c):d==="graph"&&(i==="vertical"?n(c):h(c))},L=p.useRef(null),M=()=>{if(L.current){const c=L.current.getBoundingClientRect();return i==="vertical"?c.top:c.left}return 0};p.useEffect(()=>(window.addEventListener("mousemove",_),window.addEventListener("mouseup",C),()=>{window.removeEventListener("mousemove",_),window.removeEventListener("mouseup",C)}));const R=p.Children.toArray(t.children).filter(Boolean);if(R.length===1)return e.jsx(e.Fragment,{children:R[0]});const l=i==="vertical"?`${j}px 1fr`:`${j}px 1fr`;return e.jsxs("div",{ref:L,className:"pgv-split-view__container",style:{display:"grid",gridTemplateColumns:i==="vertical"?void 0:l,gridTemplateRows:i==="vertical"?l:void 0},children:[e.jsxs("div",{className:E("pgv-split-view__side-panel",{"pgv-split-view__side-panel--vertical":i==="vertical"}),children:[R[0],e.jsx("div",{ref:k,onMouseDown:b,onDoubleClick:N,className:`pgv-split-view__divider ${i==="vertical"?"pgv-split-view__divider--vertical":""}`})]}),e.jsx("div",{children:R[1]})]})}function me({agent:t}){if(!t)return null;const s=t==="built-in"?"Jenkins":t,h=n(t);function n(u){const o=u==="built-in"?"(built-in)":u;return`${document.head.dataset.rooturl}/computer/${o}/`}return e.jsx("li",{className:"jenkins-mobile-hide",children:e.jsxs("a",{href:h,className:"jenkins-button jenkins-button--tertiary",target:"_blank",rel:"noreferrer",children:[e.jsx("svg",{width:"512px",height:"512px",viewBox:"0 0 512 512",version:"1.1",xmlns:"http://www.w3.org/2000/svg",children:e.jsx("g",{stroke:"none",strokeWidth:"1",fill:"none",fillRule:"evenodd",strokeLinejoin:"round",children:e.jsxs("g",{transform:"translate(32.000000, 64.000000)",stroke:"currentColor",strokeWidth:"32",children:[e.jsx("rect",{x:"0",y:"0",width:"448",height:"320",rx:"32"}),e.jsx("polygon",{strokeLinecap:"round",fillRule:"nonzero",points:"272 384 264 320 184 320 176 384"}),e.jsx("line",{x1:"336",y1:"384",x2:"112",y2:"384",strokeLinecap:"round"})]})})}),s]})})}const J=e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 512 512",children:[e.jsx("path",{d:"M416 221.25V416a48 48 0 01-48 48H144a48 48 0 01-48-48V96a48 48 0 0148-48h98.75a32 32 0 0122.62 9.37l141.26 141.26a32 32 0 019.37 22.62z",fill:"none",stroke:"currentColor",strokeLinejoin:"round",strokeWidth:"32"}),e.jsx("path",{d:"M256 56v120a32 32 0 0032 32h120M176 288h160M176 368h160",fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"32"})]}),we=e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 512 512",children:[e.jsx("rect",{x:"32",y:"48",width:"448",height:"416",rx:"48",ry:"48",fill:"none",stroke:"currentColor",strokeLinejoin:"round",strokeWidth:"32"}),e.jsx("path",{fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"32",d:"M96 112l80 64-80 64M192 240h64"})]}),ke=e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 512 512",children:e.jsx("path",{fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"32",d:"M262.29 192.31a64 64 0 1057.4 57.4 64.13 64.13 0 00-57.4-57.4zM416.39 256a154.34 154.34 0 01-1.53 20.79l45.21 35.46a10.81 10.81 0 012.45 13.75l-42.77 74a10.81 10.81 0 01-13.14 4.59l-44.9-18.08a16.11 16.11 0 00-15.17 1.75A164.48 164.48 0 01325 400.8a15.94 15.94 0 00-8.82 12.14l-6.73 47.89a11.08 11.08 0 01-10.68 9.17h-85.54a11.11 11.11 0 01-10.69-8.87l-6.72-47.82a16.07 16.07 0 00-9-12.22 155.3 155.3 0 01-21.46-12.57 16 16 0 00-15.11-1.71l-44.89 18.07a10.81 10.81 0 01-13.14-4.58l-42.77-74a10.8 10.8 0 012.45-13.75l38.21-30a16.05 16.05 0 006-14.08c-.36-4.17-.58-8.33-.58-12.5s.21-8.27.58-12.35a16 16 0 00-6.07-13.94l-38.19-30A10.81 10.81 0 0149.48 186l42.77-74a10.81 10.81 0 0113.14-4.59l44.9 18.08a16.11 16.11 0 0015.17-1.75A164.48 164.48 0 01187 111.2a15.94 15.94 0 008.82-12.14l6.73-47.89A11.08 11.08 0 01213.23 42h85.54a11.11 11.11 0 0110.69 8.87l6.72 47.82a16.07 16.07 0 009 12.22 155.3 155.3 0 0121.46 12.57 16 16 0 0015.11 1.71l44.89-18.07a10.81 10.81 0 0113.14 4.58l42.77 74a10.8 10.8 0 01-2.45 13.75l-38.21 30a16.05 16.05 0 00-6.05 14.08c.33 4.14.55 8.3.55 12.47z"})});function Se({stage:t}){return t?e.jsxs("div",{className:"pgv-stage-details "+oe(t.state,t.skeleton),children:[t.state==="running"&&e.jsx("div",{className:"pgv-stage-details__running"}),e.jsxs("div",{children:[e.jsx(V,{status:t.state,skeleton:t.skeleton,percentage:t.completePercent}),e.jsx("h2",{children:t.name})]}),e.jsxs("ul",{children:[e.jsxs("li",{children:[e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 512 512",children:[e.jsx("path",{d:"M112.91 128A191.85 191.85 0 0064 254c-1.18 106.35 85.65 193.8 192 194 106.2.2 192-85.83 192-192 0-104.54-83.55-189.61-187.5-192a4.36 4.36 0 00-4.5 4.37V152",fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"32"}),e.jsx("path",{d:"M233.38 278.63l-79-113a8.13 8.13 0 0111.32-11.32l113 79a32.5 32.5 0 01-37.25 53.26 33.21 33.21 0 01-8.07-7.94z",fill:"currentColor"})]}),e.jsx($,{ms:t.totalDurationMillis})]}),e.jsx("li",{children:e.jsx(O,{content:se(t.startTimeMillis),children:e.jsxs("span",{children:[e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 512 512",children:[e.jsx("path",{d:"M256 64C150 64 64 150 64 256s86 192 192 192 192-86 192-192S362 64 256 64z",fill:"none",stroke:"currentColor",strokeMiterlimit:"10",strokeWidth:"32"}),e.jsx("path",{fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"32",d:"M256 128v144h96"})]}),e.jsx(ne,{since:t.startTimeMillis})]})})}),t.pauseDurationMillis!==0&&e.jsxs("li",{className:"jenkins-mobile-hide",children:[e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 512 512",children:[e.jsx("path",{d:"M145.61 464h220.78c19.8 0 35.55-16.29 33.42-35.06C386.06 308 304 310 304 256s83.11-51 95.8-172.94c2-18.78-13.61-35.06-33.41-35.06H145.61c-19.8 0-35.37 16.28-33.41 35.06C124.89 205 208 201 208 256s-82.06 52-95.8 172.94c-2.14 18.77 13.61 35.06 33.41 35.06z",fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"32"}),e.jsx("path",{d:"M343.3 432H169.13c-15.6 0-20-18-9.06-29.16C186.55 376 240 356.78 240 326V224c0-19.85-38-35-61.51-67.2-3.88-5.31-3.49-12.8 6.37-12.8h142.73c8.41 0 10.23 7.43 6.4 12.75C310.82 189 272 204.05 272 224v102c0 30.53 55.71 47 80.4 76.87 9.95 12.04 6.47 29.13-9.1 29.13z",fill:"currentColor"})]}),e.jsx(ie,{since:t.pauseDurationMillis})]}),e.jsx(me,{agent:t.agent}),e.jsx("li",{children:e.jsx(K,{className:"jenkins-button--tertiary",disabled:t.synthetic&&!t.placeholder,items:[{text:"View stage as plain text",icon:J,href:`log?nodeId=${t.id}`,target:"_blank"},{text:"Download stage logs",icon:e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 512 512",children:[e.jsx("path",{d:"M336 176h40a40 40 0 0140 40v208a40 40 0 01-40 40H136a40 40 0 01-40-40V216a40 40 0 0140-40h40",fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"32"}),e.jsx("path",{fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"32",d:"M176 272l80 80 80-80M256 48v288"})]}),href:`log?nodeId=${t.id}`,download:`${t.name}.txt`}]})})]})]}):null}const ye=p.lazy(()=>U(()=>import("./ConsoleLogStream-G6D9AFo_.js"),__vite__mapDeps([0,1,2]),import.meta.url));function be(t){p.useEffect(()=>{t.isExpanded&&t.onMoreConsoleClick(t.step.id,t.stepBuffer.startByte)},[t.isExpanded]);const s=o=>{o.button!==0||o.metaKey||o.ctrlKey||(o.preventDefault(),history.replaceState({},"","?selected-node="+t.step.id),t.onStepToggle(t.step.id))},h=()=>{let o=t.stepBuffer.startByte-B;o<0&&(o=0),t.onMoreConsoleClick(t.step.id,o)},n=()=>{if(t.stepBuffer.lines&&t.stepBuffer.startByte>0)return e.jsxs("button",{onClick:h,className:"pgv-show-more-logs jenkins-button jenkins-!-warning-color",children:["Thereâ€™s more to see - ",u(t.stepBuffer.startByte)," ","of logs hidden"]})},u=o=>o<1024?`${o}B`:o<1048576?`${(o/1024).toFixed(2)}KiB`:o<1073741824?`${(o/1048576).toFixed(2)}MiB`:`${(o/1073741824).toFixed(2)}GiB`;return e.jsxs("div",{className:"pgv-step-detail-group",children:[e.jsxs("div",{className:E("pgv-step-detail-header","jenkins-button",{"jenkins-button--tertiary":!t.isExpanded}),children:[e.jsxs("a",{href:"?selected-node="+t.step.id,onClick:s,children:[e.jsxs("div",{className:"pgv-step-detail-header__content",children:[e.jsx(V,{status:t.step.state,percentage:t.step.completePercent}),t.step.title!==""&&e.jsx("span",{children:t.step.title}),t.step.name!==""&&e.jsx("span",{children:t.step.name}),e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 512 512",className:"pgv-step-detail-header__chevron",style:{rotate:t.isExpanded?"90deg":"0deg"},children:e.jsx("path",{fill:"none",stroke:"var(--text-color-secondary)",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"48",opacity:.75,d:"M184 112l144 144-144 144"})})]}),e.jsx("div",{className:"pgv-step-detail-header__actions",children:e.jsx("span",{style:{color:"var(--text-color-secondary)",fontWeight:"normal"},children:e.jsx($,{ms:t.step.totalDurationMillis})})})]},`step-action-area-${t.step.id}`),e.jsx(O,{content:"View step as plain text",children:e.jsx("a",{href:`log?nodeId=${t.step.id}`,className:"jenkins-button jenkins-button--tertiary",target:"_blank",rel:"noreferrer",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 512 512",children:e.jsx("path",{d:"M384 224v184a40 40 0 01-40 40H104a40 40 0 01-40-40V168a40 40 0 0140-40h167.48M336 64h112v112M224 288L440 72",fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"32"})})})})]}),t.isExpanded&&e.jsxs("div",{style:{paddingTop:"0.5rem"},children:[n(),e.jsx(p.Suspense,{children:e.jsx(ye,{logBuffer:t.stepBuffer,onMoreConsoleClick:t.onMoreConsoleClick,step:t.step,maxHeightScale:.65})})]})]},`step-card-${t.step.id}`)}function Ce({stage:t,stepBuffers:s,steps:h,onStepToggle:n,expandedSteps:u,onMoreConsoleClick:o}){return h.length===0?null:e.jsx("div",{className:"pgv-stage-steps",children:h.map(r=>e.jsx(be,{step:r,stepBuffer:s.get(r.id)??{lines:[],startByte:0-B,endByte:-1},onStepToggle:n,isExpanded:u.includes(r.id),onMoreConsoleClick:o},`step-console-card-${r.id}`))},`stage-steps-container-${t?t.id:"unk"}`)}function _e(t){return e.jsxs(e.Fragment,{children:[e.jsx(Se,{stage:t.stage}),e.jsx(Ce,{stage:t.stage,steps:t.steps,stepBuffers:t.stepBuffers,expandedSteps:t.expandedSteps,onStepToggle:t.onStepToggle,onMoreConsoleClick:t.onMoreConsoleClick})]})}function Ee(){const t=document.getElementById("console-pipeline-root"),s=t==null?void 0:t.dataset.currentRunPath,h=t==null?void 0:t.dataset.previousRunPath,[n,u]=p.useState(!1);p.useEffect(()=>{var N,L;const _=(N=document.getElementById("console-pipeline-overflow-root"))==null?void 0:N.dataset.proxyName;_&&((L=window[_])==null||L.hasConfigurePermission(function(M){u(M==null?void 0:M.responseJSON)}))},[n]);const{stageViewPosition:o,mainViewVisibility:r}=F(),{openStage:i,openStageSteps:d,openStageStepBuffers:x,expandedSteps:m,stages:f,handleStageSelect:S,onStepToggle:j,onMoreConsoleClick:w,loading:k}=pe({currentRunPath:s,previousRunPath:h}),b=k||!k&&f.length>0,C=f.length===1&&f[0].placeholder;return e.jsxs(e.Fragment,{children:[e.jsx(re,{children:e.jsx(K,{items:[b?e.jsx(le,{},"visibility-select"):e.jsx(e.Fragment,{}),{text:"View as plain text",icon:J,href:"../consoleText"},{text:"View classic console",icon:we,href:"../console"},n?{text:"Configure",icon:ke,href:"../../configure"}:e.jsx(e.Fragment,{})]})}),b&&e.jsxs(I,{direction:o==="top"?"vertical":"horizontal",storageKey:"graph",children:[!C&&(r==="both"||r==="graphOnly")&&(k?e.jsx(W,{}):e.jsx(Q,{stages:f,selectedStage:i||void 0,stageViewPosition:o,onStageSelect:S})),e.jsxs(I,{storageKey:"stages",children:[(r==="both"||r==="stagesOnly")&&!C&&e.jsx("div",{id:"tree-view-pane",className:"pgv-sticky-sidebar",children:k?e.jsxs("div",{className:"pgv-skeleton-column",children:[e.jsx(W,{height:2.625}),e.jsx(W,{height:20})]}):e.jsx(de,{onNodeSelect:(_,N)=>S(N),selected:i==null?void 0:i.id,stages:f})},"tree-view"),e.jsx("div",{id:"stage-view-pane",children:k?e.jsxs("div",{className:"pgv-skeleton-column",children:[e.jsx(W,{height:2.625}),e.jsx(W,{height:20})]}):e.jsx(_e,{stage:i,steps:d,stepBuffers:x,expandedSteps:m,onStepToggle:j,onMoreConsoleClick:w})},"stage-view")]})]}),!k&&f.length===0&&e.jsx(je,{}),e.jsx(ve,{})]})}export{Ee as default};
//# sourceMappingURL=PipelineConsole-BeuvY6Zx.js.map
